<!DOCTYPE html>

<html lang="en">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Conversation Tool by Afc Rulex</title>

    <style>

        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');

        

        * {

            margin: 0;

            padding: 0;

            box-sizing: border-box;

        }

        body {

            font-family: 'Inter', sans-serif;

            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);

            min-height: 100vh;

            padding: 30px 20px;

        }

        .container {

            max-width: 1200px;

            margin: 0 auto;

        }

        .header {

            background: white;

            border-radius: 20px;

            padding: 28px 35px;

            margin-bottom: 30px;

            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);

            display: flex;

            justify-content: space-between;

            align-items: center;

        }

        .header-left {

            display: flex;

            align-items: center;

            gap: 18px;

        }

        .logo-small {

            width: 50px;

            height: 50px;

            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);

            border-radius: 12px;

            display: flex;

            align-items: center;

            justify-content: center;

            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);

        }

        .logo-small svg {

            width: 26px;

            height: 26px;

            fill: white;

        }

        .header h1 {

            font-size: 26px;

            font-weight: 700;

            color: #2d3748;

        }

        .logout-btn {

            padding: 12px 26px;

            background: white;

            color: #e53e3e;

            border: 2px solid #e53e3e;

            border-radius: 10px;

            font-size: 14px;

            font-weight: 600;

            cursor: pointer;

            transition: all 0.3s ease;

            text-decoration: none;

            display: inline-block;

            font-family: 'Inter', sans-serif;

        }

        .logout-btn:hover {

            background: #e53e3e;

            color: white;

            transform: translateY(-2px);

            box-shadow: 0 6px 20px rgba(229, 62, 62, 0.3);

        }

        .card {

            background: white;

            border-radius: 20px;

            padding: 35px;

            margin-bottom: 30px;

            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);

            transition: all 0.3s ease;

        }

        .card:hover {

            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.12);

            transform: translateY(-3px);

        }

        .card-header {

            display: flex;

            align-items: center;

            gap: 12px;

            margin-bottom: 28px;

            padding-bottom: 18px;

            border-bottom: 2px solid #f7fafc;

        }

        .card-icon {

            font-size: 28px;

        }

        .card-header h2 {

            font-size: 22px;

            font-weight: 700;

            color: #2d3748;

        }

        .form-grid {

            display: grid;

            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));

            gap: 20px;

            margin-bottom: 20px;

        }

        .form-group label {

            display: block;

            color: #4a5568;

            font-weight: 600;

            margin-bottom: 8px;

            font-size: 13px;

        }

        .form-group input,

        .form-group select {

            width: 100%;

            padding: 13px 16px;

            background: #f7fafc;

            border: 2px solid #e2e8f0;

            border-radius: 10px;

            font-size: 14px;

            color: #2d3748;

            transition: all 0.3s ease;

            font-family: 'Inter', sans-serif;

        }

        .form-group input:focus {

            outline: none;

            background: white;

            border-color: #667eea;

            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);

        }

        .form-group input::placeholder {

            color: #a0aec0;

        }

        .file-input-wrapper {

            position: relative;

            overflow: hidden;

        }

        .file-input-wrapper input[type=file] {

            position: absolute;

            left: -9999px;

        }

        .file-input-label {

            display: block;

            padding: 13px 16px;

            background: #edf2f7;

            border: 2px dashed #cbd5e0;

            border-radius: 10px;

            text-align: center;

            cursor: pointer;

            transition: all 0.3s ease;

            color: #4a5568;

            font-weight: 600;

            font-size: 14px;

        }

        .file-input-label:hover {

            background: #e2e8f0;

            border-color: #667eea;

            color: #667eea;

        }

        .file-input-label.selected {

            background: #c6f6d5;

            border-color: #48bb78;

            color: #22543d;

        }

        .submit-btn {

            width: 100%;

            padding: 16px;

            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);

            color: white;

            border: none;

            border-radius: 12px;

            font-size: 15px;

            font-weight: 600;

            cursor: pointer;

            transition: all 0.3s ease;

            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);

            font-family: 'Inter', sans-serif;

        }

        .submit-btn:hover {

            transform: translateY(-2px);

            box-shadow: 0 12px 30px rgba(102, 126, 234, 0.4);

        }

        .task-card {

            background: white;

            border-radius: 16px;

            padding: 20px;

            margin-bottom: 18px;

            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);

            transition: all 0.3s ease;

            border-left: 4px solid #48bb78;

            max-width: 100%;

            overflow: hidden;

        }

        .task-card:hover {

            transform: translateY(-3px);

            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.12);

        }

        .task-header {

            display: flex;

            justify-content: space-between;

            align-items: center;

            margin-bottom: 14px;

            gap: 10px;

        }

        .task-name-wrapper {

            display: flex;

            align-items: center;

            gap: 10px;

            flex: 1;

            min-width: 0;

        }

        .running-indicator {

            width: 10px;

            height: 10px;

            background: #48bb78;

            border-radius: 50%;

            animation: pulse-dot 2s infinite;

            flex-shrink: 0;

        }

        @keyframes pulse-dot {

            0%, 100% { opacity: 1; transform: scale(1); }

            50% { opacity: 0.5; transform: scale(1.3); }

        }

        .task-name {

            font-size: 16px;

            font-weight: 700;

            color: #2d3748;

            overflow: hidden;

            text-overflow: ellipsis;

            white-space: nowrap;

        }

        .task-id {

            font-size: 11px;

            color: #718096;

            background: #edf2f7;

            padding: 4px 8px;

            border-radius: 6px;

            font-weight: 600;

            flex-shrink: 0;

        }

        .task-info {

            background: #f7fafc;

            border-radius: 10px;

            padding: 14px;

            margin-bottom: 14px;

        }

        .task-prefix {

            display: inline-block;

            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);

            color: white;

            padding: 5px 12px;

            border-radius: 6px;

            font-size: 11px;

            font-weight: 600;

            margin-bottom: 10px;

            max-width: 100%;

            overflow: hidden;

            text-overflow: ellipsis;

            white-space: nowrap;

        }

        .task-stats {

            display: grid;

            grid-template-columns: repeat(2, 1fr);

            gap: 8px;

        }

        .stat-item {

            background: white;

            border: 1px solid #e2e8f0;

            padding: 10px;

            border-radius: 8px;

            text-align: center;

        }

        .stat-label {

            font-size: 9px;

            color: #718096;

            margin-bottom: 4px;

            text-transform: uppercase;

            letter-spacing: 0.5px;

            font-weight: 600;

        }

        .stat-value {

            font-size: 16px;

            font-weight: 700;

            color: #2d3748;

        }

        .stat-value.success {

            color: #48bb78;

        }

        .stat-value.failed {

            color: #f56565;

        }

        .stat-value.uptime {

            color: #667eea;

        }

        .stat-value.tokens {

            color: #ed8936;

        }

        .stop-form {

            display: flex;

            gap: 8px;

            margin-top: 14px;

        }

        .stop-form input {

            flex: 1;

            padding: 10px 12px;

            background: #f7fafc;

            border: 2px solid #e2e8f0;

            border-radius: 10px;

            font-size: 12px;

            color: #2d3748;

            font-family: 'Inter', sans-serif;

            min-width: 0;

        }

        .stop-form input::placeholder {

            color: #a0aec0;

        }

        .stop-btn {

            padding: 10px 18px;

            background: #e53e3e;

            color: white;

            border: none;

            border-radius: 10px;

            font-weight: 600;

            cursor: pointer;

            transition: all 0.3s ease;

            font-family: 'Inter', sans-serif;

            font-size: 12px;

            flex-shrink: 0;

        }

        .stop-btn:hover {

            background: #c53030;

            transform: translateY(-2px);

            box-shadow: 0 6px 20px rgba(229, 62, 62, 0.3);

        }

        .no-tasks {

            text-align: center;

            padding: 50px 20px;

            color: #a0aec0;

            font-size: 15px;

        }

        .no-tasks-icon {

            font-size: 56px;

            margin-bottom: 16px;

            opacity: 0.4;

        }

        @media (max-width: 768px) {

            .header {

                flex-direction: column;

                gap: 16px;

                text-align: center;

            }

            .form-grid {

                grid-template-columns: 1fr;

            }

            .task-stats {

                grid-template-columns: 1fr;

            }

            .task-header {

                flex-direction: column;

                align-items: flex-start;

            }

            .task-name {

                font-size: 14px;

            }

            .stop-form {

                flex-direction: column;

            }

            .stop-btn {

                width: 100%;

            }

        }

    </style>

</head>

<body>

    <div class="container">

        <div class="header">

            <div class="header-left">

                <div class="logo-small">

                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">

                        <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"/>

                    </svg>

                </div>

                <h1>Conversation Tool</h1>

            </div>

            <a href="/logout" class="logout-btn">Logout</a>

        </div>

        <div class="card">

            <div class="card-header">

                <span class="card-icon">üöÄ</span>

                <h2>Create New Task</h2>

            </div>

            <form method="POST" enctype="multipart/form-data">

                <div class="form-grid">

                    <div class="form-group">

                        <label for="task_name">Task Name</label>

                        <input type="text" id="task_name" name="task_name" required placeholder="Enter task name">

                    </div>

                    <div class="form-group">

                        <label for="task_password">Task Password</label>

                        <input type="password" id="task_password" name="task_password" required placeholder="Set task password">

                    </div>

                    <div class="form-group">

                        <label for="convo_id">Conversation ID</label>

                        <input type="text" id="convo_id" name="convo_id" required placeholder="Enter conversation ID">

                    </div>

                    <div class="form-group">

                        <label for="prefix">Hater's Name</label>

                        <input type="text" id="prefix" name="prefix" required placeholder="Enter message prefix">

                    </div>

                    <div class="form-group">

                        <label for="speed">Speed (seconds)</label>

                        <input type="number" id="speed" name="speed" required placeholder="Enter speed" min="1" value="5">

                    </div>

                </div>

                <div class="form-grid">

                    <div class="form-group">

                        <label>Token File</label>

                        <div class="file-input-wrapper">

                            <input type="file" id="token_file" name="token_file" required accept=".txt">

                            <label for="token_file" class="file-input-label">üìÅ Choose Token File</label>

                        </div>

                    </div>

                    <div class="form-group">

                        <label>Message File</label>

                        <div class="file-input-wrapper">

                            <input type="file" id="message_file" name="message_file" required accept=".txt">

                            <label for="message_file" class="file-input-label">üìÅ Choose Message File</label>

                        </div>

                    </div>

                </div>

                <button type="submit" class="submit-btn">Start Process</button>

            </form>

        </div>

        <div class="card">

            <div class="card-header">

                <span class="card-icon">‚ö°</span>

                <h2>Running Process</h2>

            </div>

            

            <div id="tasks-container">

                {% if running_tasks %}

                    {% for task in running_tasks %}

                    <div class="task-card">

                        <div class="task-header">

                            <div class="task-name-wrapper">

                                <span class="running-indicator"></span>

                                <span class="task-name">{{ task.task_name }}</span>

                            </div>

                            <span class="task-id">ID: {{ task.id }}</span>

                        </div>

                        <div class="task-info">

                            <div class="task-prefix">

                                üìù Hater's Name: {{ task.prefix }}

                            </div>

                            <div class="task-stats">

                                <div class="stat-item">

                                    <div class="stat-label">Uptime</div>

                                    <div class="stat-value uptime">{{ task.uptime }}</div>

                                </div>

                                <div class="stat-item">

                                    <div class="stat-label">Total Tokens</div>

                                    <div class="stat-value tokens">{{ task.total_tokens }}</div>

                                </div>

                                <div class="stat-item">

                                    <div class="stat-label">Total Messages</div>

                                    <div class="stat-value">{{ task.total_messages }}</div>

                                </div>

                                <div class="stat-item">

                                    <div class="stat-label">Total Messages</div>

                                    <div class="stat-value success">{{ task.running_tokens }}</div>

                                </div>

                                <div class="stat-item">

                                    <div class="stat-label">Failed Messages</div>

                                    <div class="stat-value failed">{{ task.failed_tokens }}</div>

                                </div>

                            </div>

                        </div>

                        <form method="POST" action="/stop/{{ task.id }}" class="stop-form" onsubmit="return stopTask(event, '{{ task.id }}')">

                            <input type="password" name="password" placeholder="Enter password to stop" required>

                            <button type="submit" class="stop-btn">Stop Process</button>

                        </form>

                    </div>

                    {% endfor %}

                {% else %}

                    <div class="no-tasks">

                        <div class="no-tasks-icon">üìä</div>

                        <p>No running tasks at the moment.<br>Create a new task to get started!</p>

                    </div>

                {% endif %}

            </div>

        </div>

    </div>

    <script>

        // File input handling

        document.querySelectorAll('input[type=file]').forEach(input => {

            input.addEventListener('change', function(e) {

                const label = this.nextElementSibling;

                const fileName = e.target.files[0]?.name || 'Choose File';

                label.textContent = '‚úì ' + fileName;

                label.classList.add('selected');

            });

        });

        // Stop task with AJAX

        function stopTask(event, taskId) {

            event.preventDefault();

            const form = event.target;

            const password = form.querySelector('input[name="password"]').value;

            

            fetch('/stop/' + taskId, {

                method: 'POST',

                headers: {

                    'Content-Type': 'application/x-www-form-urlencoded',

                },

                body: 'password=' + encodeURIComponent(password)

            })

            .then(response => response.json())

            .then(data => {

                if (data.success) {

                    alert('‚úì Task stopped successfully!');

                    refreshTasks();

                } else {

                    alert('‚úó Error: ' + data.error);

                }

            })

            .catch(error => {

                alert('‚úó Error stopping task: ' + error);

            });

            

            return false;

        }

        // Refresh only tasks section without full page reload

        function refreshTasks() {

            fetch(window.location.href)

                .then(response => response.text())

                .then(html => {

                    const parser = new DOMParser();

                    const doc = parser.parseFromString(html, 'text/html');

                    const newTasksContainer = doc.querySelector('#tasks-container');

                    if (newTasksContainer) {

                        document.querySelector('#tasks-container').innerHTML = newTasksContainer.innerHTML;

                    }

                })

           
